<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>

        <!-- Indent Form View -->
        <record id='view_indent_indent_form' model='ir.ui.view'>
            <field name="name">indent.indent.form</field>
            <field name="model">indent.indent</field>
            <field name="arch" type="xml">
                <form string="Indents" version="7.0">
                    <header>
                        <button name="indent_confirm" string="Confirm" states="draft" class="oe_highlight"/>
                        <button name="indent_validate" string="Validate" states="confirm" class="oe_highlight"/>
                        <button name="indent_reject" string="Reject" states="confirm"/>
                        <button name="indent_inprogress" string="Approve" states="waiting_approval" class="oe_highlight"/>
                        <button name="indent_reject" string="Reject" states="waiting_approval"/>
                        <button name="action_receive_products" string="Receive Product(s)" states="inprogress" class="oe_highlight" type="object"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,confirm,waiting_approval,inprogress,received" statusbar_colors='{"reject":"red"}'/>
                    </header>
                    <sheet>
                        <h1>
                            <label for="name" class="oe_edit_only"/>
                            <field name="name"/>
                        </h1>
                        <group>
                            <group>
                                <field name="indent_date"/>
                            </group>
                            <group>
                                <field name="required_date"/>
                            </group>
                        </group>
                        <group string="Indent Details">
                            <group>
                                <field name="indentor_id"/>
                                <field name="department_id"/>
                                <field name="analytic_account_id"/>
                            </group>
                            <group>
                                <field name="requirement"/>
                                <field name="type"/>
                                <field name="company_id"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Products">
                                <field name="product_lines">
                                    <form string="Products" version="7.0">
                                        <group>
                                            <group>
                                                <field name="product_id"
                                                    groups="base.group_user"
                                                    on_change="product_id_change(product_id, product_uom_qty, product_uom, product_uos_qty, product_uos, name, parent.indent_date)"/>
                                                <label for="product_uom_qty"/>
                                                <div>
                                                    <field
                                                        name="product_uom_qty" class="oe_inline"
                                                        on_change="product_id_change(product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name, parent.indent_date)"/>
                                                    <field name="product_uom" groups="product.group_uom" class="oe_inline oe_no_button"
                                                        on_change="product_uom_change(product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name, parent.indent_date)"/>
                                                </div>
                                                <label for="product_uos_qty" groups="product.group_uos"/>
                                                <div groups="product.group_uos">
                                                    <field name="product_uos_qty" class="oe_inline"/>
                                                    <field name="product_uos" options='{"no_open": True}' class="oe_inline"/>
                                                </div>
                                            </group>
                                            <group>
                                                <field name="type"/>
                                                <field name="qty_available"/>
                                            </group>
                                        </group>
                                        <label for="name"/>
                                        <field name="name"/>
                                        <label for="specification"/>
                                        <field name="specification"/>
                                    </form>
                                    <tree string="Products">
                                        <field name="product_id"
                                            groups="base.group_user"
                                            on_change="product_id_change(product_id, product_uom_qty, product_uom, product_uos_qty, product_uos, name, parent.indent_date)"/>
                                        <field name="product_uom" string="Unit"
                                            on_change="product_uom_change(product_id, product_uom_qty, product_uom, product_uos_qty, product_uos, name, parent.indent_date)"
                                            groups="product.group_uom" options='{"no_open": True}'/>
                                        <field name="qty_available"/>
                                        <field name="product_uom_qty"
                                            on_change="product_id_change(product_id, product_uom_qty, product_uom, product_uos_qty, product_uos, name, parent.indent_date)"/>
                                        <field name="product_uos_qty" groups="product.group_uos" invisible="1"/>
                                        <field name="product_uos" string="UoS" groups="product.group_uos" invisible="1"/>
                                        <field name="name"/>
                                        <field name="specification"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Document Status">
                                <field name="indent_authority_ids">
                                    <tree string="Document Status" editable="bottom">
                                        <field name="date"/>
                                        <field name="name"/>
                                        <field name="priority"/>
                                        <field name="description"/>
                                        <field name="state"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                        <label for="description"/>
                        <field name="description"/>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Indent Tree View -->
        <record id='view_indent_indent_tree' model='ir.ui.view'>
            <field name="name">indent.indent.tree</field>
            <field name="model">indent.indent</field>
            <field name="arch" type="xml">
                <tree string="Indents">
                    <field name="indentor_id"/>
                    <field name="indent_date"/>
                    <field name="required_date"/>
                    <field name="department_id"/>
                    <field name="analytic_account_id"/>
                    <field name="requirement"/>
                    <field name="type"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <!-- Indent Search View -->
        <record id="view_indent_indent_search" model="ir.ui.view">
            <field name="name">indent.indent.search</field>
            <field name="model">indent.indent</field>
            <field name="arch" type="xml">
                <search string="Indents">
                    <field name="name" string="Indent Name"/>
                    <field name="indent_date"/>
                    <field name="required_date"/>
                    <filter string="Draft" name="state_draft" domain="[('state','=','draft')]"/>
                    <filter string="Confirm" name="state_confirm" domain="[('state','=','confirm')]"/>
                    <filter string="Waiting For Approval" name="state_waiting_approval" domain="[('state','=','waiting_approval')]"/>
                    <filter string="Inprogress" name="state_inprogress" domain="[('state','=','inprogress')]"/>
                    <filter string="Received" name="state_received" domain="[('state','=','received')]"/>
                    <filter string="Rejected" name="state_reject" domain="[('state','=','reject')]"/>
                    <field name="indentor_id"/>
                    <field name="department_id"/>
                    <field name="analytic_account_id"/>
                    <group expand="0" string="Group By...">
                        <filter string="Indentor" context="{'group_by': 'indentor_id'}"/>
                        <filter string="Department" context="{'group_by': 'department_id'}"/>
                        <filter string="Project" context="{'group_by': 'analytic_account_id'}"/>
                        <filter string="Requirement" context="{'group_by': 'requirement'}"/>
                        <filter string="Indent Type" context="{'group_by': 'type'}"/>
                        <filter string="Status" context="{'group_by': 'state'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!-- Indent Action -->
        <record id='action_indent_indent' model='ir.actions.act_window'>
            <field name="name">Indents</field>
            <field name="res_model">indent.indent</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a new indent.
                </p>
            </field>
        </record>

        <!-- Indent Menu -->
        <menuitem name="Indents" parent="stock.menu_stock_root" id="menu_indent_indent_main" sequence="1"/>
        <menuitem action="action_indent_indent" name="Indents" parent="menu_indent_indent_main" id="menu_indent_indent" sequence="1"/>
        <menuitem id="stock.menu_stock_warehouse_mgmt" name="Receive/Deliver By Orders" parent="stock.menu_stock_root" sequence="2"/>
        <menuitem id="stock.menu_stock_products_moves" name="Receive/Deliver Products" parent="stock.menu_stock_root" sequence="3"/>

        <!-- Department Tree View -->
        <record id='view_indent_department_tree' model='ir.ui.view'>
            <field name="name">indent.department.tree</field>
            <field name="model">indent.department</field>
            <field name="arch" type="xml">
                <tree string="Departments" editable="bottom">
                    <field name="name"/>
                    <field name="code"/>
                </tree>
            </field>
        </record>

        <!-- Department Action -->
        <record id='action_indent_department' model='ir.actions.act_window'>
            <field name="name">Departments</field>
            <field name="res_model">indent.department</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a new department.
                </p>
            </field>
        </record>

        <menuitem name="Indent Management" parent="stock.menu_stock_configuration" id="menu_indent_configuration" sequence="41"/>
        <menuitem action="action_indent_department" name="Departments" parent="menu_indent_configuration" id="menu_indent_department" sequence="1"/>

        <!-- Document Authority Form View -->
        <record id="view_document_authority_form" model="ir.ui.view">
            <field name="name">document.authority.form</field>
            <field name="model">document.authority</field>
            <field name="arch" type="xml">
                <form string="Document Authority" version="7.0">
                    <sheet>
                        <group>
                            <group>
                                <field name="document"/>
                                <field name="name"/>
                            </group>
                            <group>
                                <field name="priority"/>
                                <field name="active"/>
                            </group>
                        </group>
                        <label for="description"/>
                        <field name="description"/>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Document Authority Tree View -->
        <record id='view_document_authority_tree' model='ir.ui.view'>
            <field name="name">document.authority.tree</field>
            <field name="model">document.authority</field>
            <field name="arch" type="xml">
                <tree string="Document Authorities" editable="bottom">
                    <field name="document"/>
                    <field name="name"/>
                    <field name="priority"/>
                    <field name="description"/>
                </tree>
            </field>
        </record>

        <!-- Document Authority Action -->
        <record id='action_document_authority' model='ir.actions.act_window'>
            <field name="name">Document Authorities</field>
            <field name="res_model">document.authority</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a new document authority.
                </p>
            </field>
        </record>

        <menuitem action="action_document_authority" name="Document Authorities" parent="menu_indent_configuration" id="menu_document_authority" sequence="2"/>

    </data>
</openerp>
